<!DOCTYPE html>
<html>
<head>
    <title>Woj代码评测站</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
    <style>
        body { font-family: Arial; max-width: 800px; margin: 0 auto; padding: 20px; }
        #editor { width: 100%; height: 300px; font-size: 16px; border: 1px solid #ddd; }
        button { background: #4CAF50; color: white; border: none; padding: 10px 20px; margin-top: 10px; cursor: pointer; }
        #result { margin-top: 20px; padding: 10px; background: #f5f5f5; border-left: 4px solid #4CAF50; }
    </style>
</head>
<body>
    <h1>✨ 代码评测系统 ✨</h1>
    
    <select id="language">
        <option value="54">C++</option>
        <option value="71">Python</option>
    </select>
    
    <div id="editor">#include <iostream>
using namespace std;

int main() {
    cout << "Hello World!";
    return 0;
}</div>
    
    <button onclick="runCode()">运行代码</button>
    <div id="result"></div>

    <script>
        // 初始化代码编辑器
        const editor = ace.edit("editor");
        editor.setTheme("ace/theme/chrome");
        editor.session.setMode("ace/mode/c_cpp");

        // 运行代码
        async function runCode() {
            const code = editor.getValue();
            const languageId = document.getElementById("language").value;
            const resultDiv = document.getElementById("result");
            
            resultDiv.innerHTML = "<p>评测中...（首次请求可能较慢，请耐心等待）</p>";
            
            try {
                // 提交代码到 Judge0 公共 API
                const response = await fetch("https://ce.judge0.com/submissions?wait=true", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        source_code: code,
                        language_id: languageId,
                        stdin: "",
                        redirect_stderr_to_stdout: true
                    })
                });
                const data = await response.json();
                
                // 处理结果
                let output = data.stdout || data.stderr || "无输出";
                if (data.compile_output) output = `编译错误：${data.compile_output}\n\n${output}`;
                
                resultDiv.innerHTML = `
                    <p><strong>状态：</strong> ${data.status.description}</p>
                    <p><strong>输出：</strong></p>
                    <pre>${output}</pre>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<p style="color:red">错误：${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
