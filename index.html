<!DOCTYPE html>
<html>
<head>
    <title>Woj|ç®€æ˜“çš„ä¿¡æ¯ç«èµ›å¹³å°</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.4.12/ace.js"></script>
    <style>
        /* å…¨å±€æ ·å¼ */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            background-color: #f5f5f5;
        }

        /* ä¾§è¾¹æ æ ·å¼ */
        #sidebar {
            width: 200px;
            background-color: #2c3e50;
            color: white;
            height: 100vh;
            padding: 20px;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }

        #sidebar button {
            display: block;
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            text-align: left;
        }

        #sidebar button:hover {
            background-color: #2980b9;
        }

        /* ä¸»å†…å®¹åŒº */
        #main-content {
            flex: 1;
            padding: 20px;
        }

        /* ä»£ç ç¼–è¾‘å™¨æ ·å¼ */
        #editor {
            width: 100%;
            height: 300px;
            font-size: 16px;
            border: 1px solid #ddd;
            margin-top: 20px;
        }

        /* é¢˜ç›®åˆ—è¡¨æ ·å¼ */
        #problem-list {
            display: none;
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .problem-item {
            padding: 8px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }

        .problem-item:hover {
            background-color: #f0f0f0;
        }

        /* è¿è¡ŒæŒ‰é’®å’Œé™åˆ¶æç¤º */
        #run-section {
            margin-top: 20px;
        }

        #run-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
        }

        #limits {
            margin-top: 10px;
            color: #666;
            font-size: 14px;
        }

        /* ç»“æœè¾“å‡ºåŒº */
        #result {
            margin-top: 20px;
            padding: 15px;
            background-color: white;
            border-left: 4px solid #4CAF50;
            white-space: pre-wrap;
            font-family: monospace;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .error {
            color: red;
        }
    </style>
</head>
<body>
    <!-- ä¾§è¾¹æ  -->
    <div id="sidebar">
        <h2>å¯¼èˆª</h2>
        <button onclick="showHome()">ğŸ  ä¸»é¡µ</button>
        <button onclick="showProblems()">ğŸ“š é¢˜åº“</button>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div id="main-content">
        <!-- ä¸»é¡µå†…å®¹ -->
        <div id="home-page">
            <h1>æ¬¢è¿æ¥åˆ°ä»£ç è¯„æµ‹ç³»ç»Ÿï¼</h1>
            <p>è¿™æ˜¯ä¸€ä¸ªæ”¯æŒ C++ å’Œ Python ä»£ç è¿è¡Œçš„åœ¨çº¿è¯„æµ‹å¹³å°</p>
            
            <div id="editor">#include &lt;iostream&gt;
using namespace std;

int main() {
    cout << "Hello World!";
    return 0;
}</div>

            <div id="run-section">
                <select id="language">
                    <option value="cpp">C++ (GCC 10.2.0)</option>
                    <option value="python">Python (3.10.0)</option>
                </select>
                
                <div id="limits">
                    â±ï¸ æ—¶é—´é™åˆ¶: 5ç§’ | ğŸ’¾ å†…å­˜é™åˆ¶: 256MB
                </div>
                
                <button id="run-button" onclick="runCode()">è¿è¡Œä»£ç </button>
            </div>

            <h3>è¾“å…¥ï¼ˆstdinï¼‰ï¼š</h3>
            <textarea id="stdin" rows="3" style="width:100%"></textarea>

            <h3>è¿è¡Œç»“æœï¼š</h3>
            <div id="result"></div>
        </div>

        <!-- é¢˜åº“å†…å®¹ï¼ˆé»˜è®¤éšè—ï¼‰ -->
        <div id="problem-list">
            <h2>ğŸ“š é¢˜ç›®åˆ—è¡¨</h2>
            <div class="problem-item" onclick="loadProblem(1)">1. A+B Problem</div>
            <div class="problem-item" onclick="loadProblem(2)">2. æ–æ³¢é‚£å¥‘æ•°åˆ—</div>
            <div class="problem-item" onclick="loadProblem(3)">3. æœ€å¤§å…¬çº¦æ•°</div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–ä»£ç ç¼–è¾‘å™¨ï¼ˆå¸¦è¡Œå·å’Œé«˜äº®ï¼‰
        const editor = ace.edit("editor");
        editor.setTheme("ace/theme/chrome");
        editor.session.setMode("ace/mode/c_cpp");
        editor.setOptions({
            fontSize: "14pt",
            showLineNumbers: true,
            showGutter: true
        });

        // è¯­è¨€åˆ‡æ¢
        document.getElementById("language").addEventListener("change", function() {
            const lang = this.value;
            editor.session.setMode(`ace/mode/${lang === "cpp" ? "c_cpp" : "python"}`);
        });

        // é¢˜ç›®æ•°æ®
        const problems = {
            1: {
                title: "A+B Problem",
                description: "è¾“å…¥ä¸¤ä¸ªæ•´æ•°ï¼Œè¾“å‡ºå®ƒä»¬çš„å’Œã€‚",
                template: "#include <iostream>\nusing namespace std;\n\nint main() {\n    int a, b;\n    cin >> a >> b;\n    cout << a + b;\n    return 0;\n}"
            },
            2: {
                title: "æ–æ³¢é‚£å¥‘æ•°åˆ—",
                description: "è¾“å…¥ nï¼Œè¾“å‡ºç¬¬ n ä¸ªæ–æ³¢é‚£å¥‘æ•°ï¼ˆä»1å¼€å§‹ï¼‰ã€‚",
                template: "#include <iostream>\nusing namespace std;\n\nint fib(int n) {\n    if (n <= 2) return 1;\n    return fib(n-1) + fib(n-2);\n}\n\nint main() {\n    int n;\n    cin >> n;\n    cout << fib(n);\n    return 0;\n}"
            },
            3: {
                title: "æœ€å¤§å…¬çº¦æ•°",
                description: "è¾“å…¥ä¸¤ä¸ªæ­£æ•´æ•°ï¼Œè¾“å‡ºå®ƒä»¬çš„æœ€å¤§å…¬çº¦æ•°ã€‚",
                template: "#include <iostream>\nusing namespace std;\n\nint gcd(int a, int b) {\n    return b == 0 ? a : gcd(b, a % b);\n}\n\nint main() {\n    int a, b;\n    cin >> a >> b;\n    cout << gcd(a, b);\n    return 0;\n}"
            }
        };

        // åŠ è½½é¢˜ç›®
        function loadProblem(id) {
            const problem = problems[id];
            editor.setValue(problem.template);
            document.getElementById("stdin").value = "";
            document.getElementById("result").innerHTML = `
                <h3>${id}. ${problem.title}</h3>
                <p>${problem.description}</p>
            `;
            showHome();
        }

        // æ˜¾ç¤ºä¸»é¡µ
        function showHome() {
            document.getElementById("home-page").style.display = "block";
            document.getElementById("problem-list").style.display = "none";
        }

        // æ˜¾ç¤ºé¢˜åº“
        function showProblems() {
            document.getElementById("home-page").style.display = "none";
            document.getElementById("problem-list").style.display = "block";
        }

        // è¿è¡Œä»£ç ï¼ˆä½¿ç”¨ Piston APIï¼‰
        async function runCode() {
            const code = editor.getValue();
            const language = document.getElementById("language").value;
            const stdin = document.getElementById("stdin").value;
            const resultDiv = document.getElementById("result");

            resultDiv.innerHTML = "<p>è¯„æµ‹ä¸­...ï¼ˆé¦–æ¬¡è¯·æ±‚å¯èƒ½éœ€è¦ 10 ç§’ï¼‰</p>";

            try {
                const response = await fetch("https://emkc.org/api/v2/piston/execute", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        language: language,
                        version: language === "cpp" ? "10.2.0" : "3.10.0",
                        files: [{ content: code }],
                        stdin: stdin || ""
                    })
                });

                const data = await response.json();
                let output = "";

                if (data.run.stdout) {
                    output += `<pre>${data.run.stdout}</pre>`;
                }
                if (data.run.stderr) {
                    output += `<pre class="error">${data.run.stderr}</pre>`;
                }
                if (!data.run.stdout && !data.run.stderr) {
                    output = "<p>ï¼ˆæ— è¾“å‡ºï¼‰</p>";
                }

                resultDiv.innerHTML = `
                    <h3>è¯„æµ‹ç»“æœ</h3>
                    ${output}
                    <p>â±ï¸ è¿è¡Œæ—¶é—´: ${data.run.time || 0}s</p>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <p class="error">è¯„æµ‹å¤±è´¥ï¼š${error.message}</p>
                    <p>è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•</p>
                `;
            }
        }
    </script>
</body>
</html>
